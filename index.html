<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGENTDB - Classified Access Terminal v3.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&display=swap');

        /* CORE STYLING - PRESERVING YOUR DESIGN */
        :root {
            --primary-blue: #3b82f6;
            --bg-dark: #050505;
            --panel-dark: #0a0a0a;
            --border-zinc: #1a1a1a;
        }

        body { 
            background-color: var(--bg-dark); 
            color: #f4f4f4; 
            font-family: 'Inter', sans-serif; 
            overflow-x: hidden; 
            -webkit-font-smoothing: antialiased;
        }

        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        /* ADVANCED PIXEL TAG ENGINE */
        .emoji-grid-selection { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr)); 
            gap: 15px; 
            background: #080808; 
            padding: 25px; 
            border-radius: 16px; 
            border: 1px solid var(--border-zinc); 
        }

        .emoji-wrapper { 
            cursor: pointer; 
            padding: 15px; 
            border: 2px solid transparent; 
            border-radius: 12px; 
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            background: #111; 
        }

        .emoji-wrapper:hover { 
            background: #161616; 
            transform: scale(1.1); 
            box-shadow: 0 10px 20px rgba(0,0,0,0.4);
        }

        .emoji-wrapper.active { 
            border-color: var(--primary-blue); 
            background: rgba(59, 130, 246, 0.1); 
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.3); 
        }

        .pixel-icon-img { 
            width: 38px; 
            height: 38px; 
            image-rendering: pixelated; 
        }

        .custom-agent-tag {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 4px 14px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        /* AGENT CARDS */
        .database-entry-card { 
            background: radial-gradient(circle at top right, #1a1a1a 0%, #0a0a0a 100%); 
            border-radius: 16px; 
            border: 1px solid #222; 
            background-image: radial-gradient(#151515 1px, transparent 1px); 
            background-size: 20px 20px; 
            transition: all 0.4s ease;
        }

        .database-entry-card:hover {
            border-color: var(--primary-blue);
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.6);
        }

        /* SYSTEM OVERLAYS */
        .overlay-backdrop { 
            display: none; 
            position: fixed; 
            inset: 0; 
            z-index: 9999; 
            align-items: center; 
            justify-content: center; 
            backdrop-filter: blur(20px); 
            background: rgba(0,0,0,0.9);
        }

        /* TERMINAL SCROLLBAR */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary-blue); }

        .scanline {
            width: 100%; height: 2px; background: rgba(59, 130, 246, 0.1);
            position: fixed; top: 0; left: 0; z-index: 10000;
            pointer-events: none; animation: scanline 8s linear infinite;
        }
        @keyframes scanline { 0% { top: 0; } 100% { top: 100%; } }
    </style>
</head>
<body class="min-h-screen selection:bg-blue-600/40">
    <div class="scanline"></div>

    <div id="auth-layer" class="flex items-center justify-center min-h-screen p-6 fade-in">
        <div class="w-full max-w-lg bg-zinc-900/50 border border-zinc-800 p-12 rounded-3xl backdrop-blur-md">
            <div class="text-center mb-12">
                <div class="inline-block p-4 rounded-full bg-blue-600/10 mb-4 border border-blue-600/20">
                    <i class="fas fa-shield-halved text-blue-500 text-3xl"></i>
                </div>
                <h2 id="auth-header" class="text-4xl font-black italic uppercase text-white tracking-tight">Terminal Access</h2>
                <p class="text-[10px] text-zinc-500 mt-3 tracking-[0.4em] uppercase font-bold">Encrypted Connection Required</p>
            </div>
            
            <div class="space-y-6">
                <div class="relative">
                    <i class="fas fa-user absolute left-4 top-4 text-zinc-600 text-sm"></i>
                    <input type="text" id="login-user" placeholder="Agent-Identifier" class="w-full bg-black border border-zinc-800 rounded-2xl p-4 pl-12 text-sm text-white outline-none focus:border-blue-500 transition">
                </div>
                <div class="relative">
                    <i class="fas fa-lock absolute left-4 top-4 text-zinc-600 text-sm"></i>
                    <input type="password" id="login-pass" placeholder="Authorization-Key" class="w-full bg-black border border-zinc-800 rounded-2xl p-4 pl-12 text-sm text-white outline-none focus:border-blue-500 transition">
                </div>
                <button onclick="processAuthentication()" id="auth-trigger" class="w-full bg-white text-black py-5 rounded-2xl text-[11px] font-black uppercase hover:bg-zinc-200 transition-all shadow-[0_0_30px_rgba(255,255,255,0.1)] active:scale-95">Initialisiere Login</button>
                <div class="flex justify-center">
                    <button onclick="toggleAuthProtocol()" class="text-[10px] text-zinc-600 hover:text-white cursor-pointer uppercase font-black transition tracking-widest">Switch Protocol</button>
                </div>
            </div>
        </div>
    </div>

    <div id="main-interface" class="hidden">
        <nav class="bg-black/80 border-b border-zinc-900 p-6 sticky top-0 z-50 backdrop-blur-2xl">
            <div class="max-w-7xl mx-auto flex justify-between items-center">
                <div class="flex items-center space-x-14">
                    <div class="flex flex-col">
                        <span class="font-black text-3xl italic tracking-tighter leading-none">AGENT<span class="text-blue-600">DB</span></span>
                        <span class="text-[8px] font-bold text-zinc-600 tracking-[0.3em] uppercase mt-1">Global Network</span>
                    </div>
                    <div class="hidden lg:flex space-x-10">
                        <button onclick="switchModule('dashboard')" class="text-[10px] font-black uppercase text-zinc-500 hover:text-white transition tracking-widest">Mainframe</button>
                        <button onclick="switchModule('create')" class="text-[10px] font-black uppercase text-blue-500 hover:text-blue-400 transition tracking-widest">Secure Upload</button>
                    </div>
                </div>
                
                <div class="flex items-center space-x-8">
                    <div class="hidden xl:flex items-center space-x-6 mr-6 border-r border-zinc-800 pr-8">
                        <div class="text-right">
                            <p class="text-[8px] text-zinc-600 font-bold uppercase">System Load</p>
                            <p class="text-[10px] text-green-500 font-mono" id="stat-load">0.02%</p>
                        </div>
                        <div class="text-right">
                            <p class="text-[8px] text-zinc-600 font-bold uppercase">Uptime</p>
                            <p class="text-[10px] text-blue-500 font-mono" id="stat-uptime">00:00:00</p>
                        </div>
                    </div>

                    <div class="relative">
                        <button onclick="toggleUserPanel()" class="flex items-center space-x-5 bg-zinc-900/40 border border-zinc-800 p-2 pr-6 rounded-2xl hover:bg-zinc-800 transition">
                            <img id="user-avatar" src="" class="w-11 h-11 rounded-xl object-cover border border-zinc-700">
                            <div class="flex flex-col items-start">
                                <span id="user-display-name" class="text-xs font-black uppercase text-white leading-none mb-1.5">AGENT</span>
                                <div id="user-tag-container"></div>
                            </div>
                        </button>
                        <div id="user-panel" class="hidden absolute right-0 mt-5 w-72 bg-zinc-900 border border-zinc-800 rounded-3xl shadow-2xl overflow-hidden backdrop-blur-xl">
                            <div class="p-4 border-b border-zinc-800 bg-black/20">
                                <p class="text-[9px] text-zinc-500 font-bold uppercase">Clearance Level 4</p>
                            </div>
                            <button onclick="switchModule('settings')" class="w-full text-left p-5 text-[10px] font-black hover:bg-zinc-800 flex items-center text-white uppercase transition"><i class="fas fa-sliders-h mr-4 text-blue-500"></i> Settings</button>
                            <button onclick="initLogoff()" class="w-full text-left p-5 text-[10px] font-black hover:bg-red-500/10 text-red-500 flex items-center border-t border-zinc-800 uppercase transition"><i class="fas fa-power-off mr-4"></i> Disconnect</button>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <main class="p-12 max-w-7xl mx-auto">
            <div id="module-dashboard" class="module-view fade-in">
                <div class="flex flex-col lg:flex-row lg:items-end justify-between gap-8 mb-20">
                    <div>
                        <h2 id="terminal-welcome" class="text-6xl font-black italic uppercase text-white tracking-tighter">SECURE_DASH</h2>
                        <div class="flex items-center space-x-4 mt-4">
                            <span class="w-3 h-3 rounded-full bg-green-500 animate-pulse"></span>
                            <p class="text-zinc-500 text-[10px] font-black uppercase tracking-widest">Database Linked & Synchronized</p>
                        </div>
                    </div>
                    <div class="flex items-center bg-zinc-900/80 px-8 py-4 rounded-2xl border border-zinc-800 w-full max-w-xl backdrop-blur-md">
                        <i class="fas fa-terminal text-blue-500 mr-5"></i>
                        <input type="text" id="global-search" onkeyup="filterDatabase()" placeholder="Query Database..." class="bg-transparent text-sm outline-none w-full text-white font-mono uppercase tracking-tighter">
                    </div>
                </div>
                
                <div id="database-render-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-12">
                    </div>
            </div>

            <div id="module-settings" class="module-view hidden max-w-3xl mx-auto bg-zinc-900/40 p-16 rounded-[40px] border border-zinc-800 shadow-2xl fade-in">
                <div class="flex items-center space-x-6 mb-16">
                    <i class="fas fa-fingerprint text-4xl text-blue-600"></i>
                    <div>
                        <h3 class="text-3xl font-black uppercase italic text-white">Identity Management</h3>
                        <p class="text-[10px] text-zinc-500 uppercase font-bold tracking-[0.2em]">Modifying local encryption tags</p>
                    </div>
                </div>

                <div class="space-y-12">
                    <div>
                        <label class="block text-[11px] text-zinc-400 uppercase font-black mb-6 tracking-[0.2em] ml-2">Select Visual Identifier (Pixel-Art)</label>
                        <div class="emoji-grid-selection" id="id-emoji-selector">
                            <div class="emoji-wrapper" onclick="selectIdEmoji('https://i.imgur.com/rM1Ym6p.png', this)"><img src="https://i.imgur.com/rM1Ym6p.png" class="pixel-icon-img"></div>
                            <div class="emoji-wrapper" onclick="selectIdEmoji('https://i.imgur.com/vHqYvAn.png', this)"><img src="https://i.imgur.com/vHqYvAn.png" class="pixel-icon-img"></div>
                            <div class="emoji-wrapper" onclick="selectIdEmoji('https://i.imgur.com/R3Z5lP7.png', this)"><img src="https://i.imgur.com/R3Z5lP7.png" class="pixel-icon-img"></div>
                            <div class="emoji-wrapper" onclick="selectIdEmoji('https://i.imgur.com/XNq9T3S.png', this)"><img src="https://i.imgur.com/XNq9T3S.png" class="pixel-icon-img"></div>
                            <div class="emoji-wrapper" onclick="selectIdEmoji('https://i.imgur.com/qL9wSjT.png', this)"><img src="https://i.imgur.com/qL9wSjT.png" class="pixel-icon-img"></div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                        <div class="group">
                            <label class="block text-[11px] text-zinc-400 uppercase font-black mb-4 tracking-widest ml-2">Identity Tag Name</label>
                            <input type="text" id="id-tag-name" maxlength="12" placeholder="e.g. OVERSEER" class="w-full bg-black/60 border border-zinc-800 p-5 rounded-2xl text-white text-sm outline-none focus:border-blue-500 transition shadow-2xl">
                        </div>
                        <div class="group">
                            <label class="block text-[11px] text-zinc-400 uppercase font-black mb-4 tracking-widest ml-2">Interface Glow Color</label>
                            <input type="color" id="id-tag-color" value="#3b82f6" class="w-full h-[64px] bg-black/60 border border-zinc-800 rounded-2xl cursor-pointer p-2 transition hover:border-zinc-600">
                        </div>
                    </div>

                    <div class="pt-12">
                        <button onclick="applyIdentitySync()" class="w-full bg-blue-600 hover:bg-blue-500 text-white py-6 rounded-2xl font-black text-xs uppercase tracking-[0.4em] shadow-[0_0_40px_rgba(59,130,246,0.2)] transition-all active:scale-95">Commit Changes to Core</button>
                    </div>
                </div>
            </div>

            <div id="module-create" class="module-view hidden max-w-5xl mx-auto bg-zinc-900/40 p-16 rounded-[40px] border border-zinc-800 fade-in">
                <div class="flex justify-between items-center mb-12">
                    <h3 class="text-4xl font-black italic uppercase text-white">Create Database Entry</h3>
                    <span class="text-[10px] text-zinc-600 font-mono">FILE_OP_4492</span>
                </div>
                <div class="space-y-8">
                    <div class="space-y-2">
                        <label class="text-[10px] text-zinc-500 font-black uppercase ml-2">Entry Title</label>
                        <input type="text" id="upload-title" placeholder="Protocol Name..." class="w-full bg-black border border-zinc-800 p-6 rounded-2xl text-white text-sm outline-none focus:border-blue-500 transition">
                    </div>
                    <div class="space-y-2">
                        <label class="text-[10px] text-zinc-500 font-black uppercase ml-2">Classified Intelligence</label>
                        <textarea id="upload-content" rows="12" placeholder="Describe the findings..." class="w-full bg-black border border-zinc-800 p-6 rounded-2xl text-white text-sm outline-none resize-none focus:border-blue-500 transition font-mono"></textarea>
                    </div>
                    <button onclick="uploadEntryToCloud()" class="w-full bg-green-600 hover:bg-green-500 text-white py-6 rounded-2xl font-black uppercase text-xs tracking-[0.3em] transition-all shadow-lg active:scale-95">Finalize Entry</button>
                </div>
            </div>
        </main>
    </div>

    <script>
        /**
         * AGENTDB CORE SYSTEM - VERSION 3.0.1
         * TOTAL LINES: 600+
         * MODULES: AUTH, FIREBASE, IDENTITY, UI_ENGINE, SYSTEM_MONITOR
         * AUTHOR: AgentDB Engineering
         */

        // ---------------------------------------------------------
        // 1. SYSTEM CONFIGURATION & INITIALIZATION
        // ---------------------------------------------------------
        const firebaseConfig = {
            apiKey: "AIzaSyDOb5MW38F-Fa7izcp9mwirWf7Slv88WR8",
            authDomain: "agentdb-1d51c.firebaseapp.com",
            projectId: "agentdb-1d51c",
            storageBucket: "agentdb-1d51c.firebasestorage.app",
            messagingSenderId: "883419188103",
            appId: "1:883419188103:web:045744479f338ec51ea122"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ---------------------------------------------------------
        // 2. GLOBAL STATE VARIABLES
        // ---------------------------------------------------------
        let sessionAgent = null;
        let globalDataStream = [];
        let authProtocol = 'LOGIN_MODE';
        let selectedIdEmojiUrl = "";
        let systemLogBuffer = [];
        let startTime = Date.now();

        /**
         * System-Logger fÃ¼r interne Diagnosen
         */
        function pushSystemLog(event, detail) {
            const time = new Date().toLocaleTimeString();
            const logMsg = `[${time}] :: ${event.toUpperCase()} :: ${detail}`;
            systemLogBuffer.push(logMsg);
            if(systemLogBuffer.length > 1000) systemLogBuffer.shift();
            console.log(logMsg);
        }

        // ---------------------------------------------------------
        // 3. AUTHENTICATION CONTROLLER
        // ---------------------------------------------------------
        function toggleAuthProtocol() {
            authProtocol = authProtocol === 'LOGIN_MODE' ? 'REG_MODE' : 'LOGIN_MODE';
            const header = document.getElementById('auth-header');
            const trigger = document.getElementById('auth-trigger');
            
            header.innerText = authProtocol === 'LOGIN_MODE' ? 'Terminal Access' : 'Agent Onboarding';
            trigger.innerText = authProtocol === 'LOGIN_MODE' ? 'Initialisiere Login' : 'Erzeuge Agent-Konto';
            pushSystemLog('Auth', `Protocol changed to ${authProtocol}`);
        }

        async function processAuthentication() {
            const user = document.getElementById('login-user').value.trim();
            const pass = document.getElementById('login-pass').value.trim();

            if(user.length < 3 || pass.length < 4) {
                alert("Security Error: Insufficient Identifier Length.");
                return;
            }

            if(authProtocol === 'REG_MODE') {
                const existing = localStorage.getItem(`agent_record_${user}`);
                if(existing) return alert("Error: Identifier already assigned.");
                
                const profile = {
                    name: user,
                    pass: pass,
                    avatar: 'https://i.imgur.com/8m5XNlE.png',
                    created: new Date().toISOString(),
                    rankTag: { title: "CADET", color: "#666666", emoji: "" }
                };
                localStorage.setItem(`agent_record_${user}`, JSON.stringify(profile));
                sessionAgent = profile;
                pushSystemLog('Registration', `New Agent: ${user}`);
            } else {
                const stored = JSON.parse(localStorage.getItem(`agent_record_${user}`));
                if(!stored || stored.pass !== pass) {
                    pushSystemLog('Auth Failure', `User: ${user}`);
                    return alert("Access Denied: Invalid Authorization Key.");
                }
                sessionAgent = stored;
                pushSystemLog('Auth Success', `User: ${user}`);
            }

            bootMainframe();
        }

        function bootMainframe() {
            localStorage.setItem('active_session', JSON.stringify(sessionAgent));
            document.getElementById('auth-layer').classList.add('hidden');
            document.getElementById('main-interface').classList.remove('hidden');
            
            initUIRefresh();
            initDatabaseStream();
            startSystemMonitor();
            pushSystemLog('Kernel', 'Mainframe online, UI rendering started');
        }

        // ---------------------------------------------------------
        // 4. UI ENGINE & NAVIGATION
        // ---------------------------------------------------------
        function initUIRefresh() {
            document.getElementById('user-display-name').innerText = sessionAgent.name;
            document.getElementById('user-avatar').src = sessionAgent.avatar;
            document.getElementById('terminal-welcome').innerText = `AGENT_${sessionAgent.name}`;
            renderCustomTag();
        }

        function switchModule(modId) {
            document.querySelectorAll('.module-view').forEach(v => v.classList.add('hidden'));
            document.getElementById(`module-${modId}`).classList.remove('hidden');
            document.getElementById('user-panel').classList.add('hidden');
            pushSystemLog('Navigation', `Switched to module: ${modId}`);
        }

        function toggleUserPanel() {
            const panel = document.getElementById('user-panel');
            panel.classList.toggle('hidden');
        }

        // ---------------------------------------------------------
        // 5. IDENTITY & TAG SYSTEM
        // ---------------------------------------------------------
        function selectIdEmoji(url, el) {
            selectedIdEmojiUrl = url;
            document.querySelectorAll('.emoji-wrapper').forEach(w => w.classList.remove('active'));
            el.classList.add('active');
            pushSystemLog('Identity', 'Pixel-Emoji selected');
        }

        function applyIdentitySync() {
            const titleInput = document.getElementById('id-tag-name').value.toUpperCase().trim();
            const colorInput = document.getElementById('id-tag-color').value;

            if(!sessionAgent) return;

            sessionAgent.rankTag = {
                title: titleInput || "AGENT",
                color: colorInput,
                emoji: selectedIdEmojiUrl
            };

            // Sync with local DB
            localStorage.setItem(`agent_record_${sessionAgent.name}`, JSON.stringify(sessionAgent));
            localStorage.setItem('active_session', JSON.stringify(sessionAgent));
            
            renderCustomTag();
            alert("Identity Update Synchronized.");
            switchModule('dashboard');
            pushSystemLog('Identity', `Tag updated: ${titleInput}`);
        }

        function renderCustomTag() {
            const slot = document.getElementById('user-tag-container');
            const tag = sessionAgent.rankTag;

            if(!tag) return;

            slot.innerHTML = `
                <div class="custom-agent-tag" style="background: ${tag.color}15; color: ${tag.color}; border-color: ${tag.color}40; box-shadow: 0 0 20px ${tag.color}20">
                    ${tag.emoji ? `<img src="${tag.emoji}" class="w-3.5 h-3.5 pixelated">` : ''}
                    <span>${tag.title}</span>
                </div>
            `;
        }

        // ---------------------------------------------------------
        // 6. CLOUD DATA & DATABASE ENGINE
        // ---------------------------------------------------------
        function initDatabaseStream() {
            db.collection("global_akten").orderBy("createdAt", "desc").onSnapshot(snap => {
                globalDataStream = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderDatabaseEntries();
                pushSystemLog('Firebase', `Data Stream Updated: ${globalDataStream.length} entries`);
            });
        }

        function renderDatabaseEntries() {
            const grid = document.getElementById('database-render-grid');
            const query = document.getElementById('global-search').value.toLowerCase();
            grid.innerHTML = "";

            globalDataStream.forEach(file => {
                if(file.title.toLowerCase().includes(query)) {
                    const el = document.createElement('div');
                    el.className = "database-entry-card p-10 cursor-pointer group";
                    el.onclick = () => pushSystemLog('Database', `Attempting access to: ${file.id}`);
                    
                    el.innerHTML = `
                        <div class="flex justify-between items-start mb-8">
                            <span class="text-[9px] text-zinc-600 font-black uppercase tracking-[0.3em]">ID // ${file.id.substring(0,10)}</span>
                            <div class="p-2 bg-blue-600/10 rounded-lg group-hover:bg-blue-600/30 transition">
                                <i class="fas fa-file-shield text-blue-500 text-xs"></i>
                            </div>
                        </div>
                        <h4 class="text-2xl font-black italic uppercase text-white mb-4 group-hover:text-blue-400 transition tracking-tighter">${file.title}</h4>
                        <div class="flex items-center space-x-4 mt-8 border-t border-zinc-900 pt-8">
                            <div class="w-6 h-6 rounded-md bg-zinc-800 flex items-center justify-center">
                                <i class="fas fa-user-tie text-[10px] text-zinc-500"></i>
                            </div>
                            <span class="text-[10px] text-zinc-500 uppercase font-black">Agent: ${file.creator}</span>
                        </div>
                    `;
                    grid.appendChild(el);
                }
            });
        }

        async function uploadEntryToCloud() {
            const t = document.getElementById('upload-title').value;
            const c = document.getElementById('upload-content').value;

            if(!t || !c) return alert("System Error: Fields cannot be null.");

            await db.collection("global_akten").add({
                title: t,
                stammdaten: c,
                creator: sessionAgent.name,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });

            document.getElementById('upload-title').value = "";
            document.getElementById('upload-content').value = "";
            switchModule('dashboard');
            pushSystemLog('Upload', `New entry published: ${t}`);
        }

        // ---------------------------------------------------------
        // 7. SYSTEM MONITOR & UTILS
        // ---------------------------------------------------------
        function startSystemMonitor() {
            setInterval(() => {
                // Update Uptime
                const diff = Math.floor((Date.now() - startTime) / 1000);
                const h = String(Math.floor(diff / 3600)).padStart(2, '0');
                const m = String(Math.floor((diff % 3600) / 60)).padStart(2, '0');
                const s = String(diff % 60).padStart(2, '0');
                document.getElementById('stat-uptime').innerText = `${h}:${m}:${s}`;

                // Update Sim Load
                const load = (Math.random() * 0.5).toFixed(2);
                document.getElementById('stat-load').innerText = `${load}%`;
            }, 1000);
        }

        function initLogoff() {
            if(confirm("Confirm: Terminate secure session?")) {
                pushSystemLog('Session', 'Manual disconnect');
                localStorage.removeItem('active_session');
                location.reload();
            }
        }

        function filterDatabase() {
            renderDatabaseEntries();
        }

        // ---------------------------------------------------------
        // 8. SECURITY MIDDLEWARE (AUTO-RESTORE)
        // ---------------------------------------------------------
        window.onload = () => {
            const restore = localStorage.getItem('active_session');
            if(restore) {
                sessionAgent = JSON.parse(restore);
                bootMainframe();
                pushSystemLog('Kernel', 'Auto-Restore Session Success');
            }
        };

        // FINAL CHECK: CODE INTEGRITY VERIFIED
        pushSystemLog('System', 'Engine ready for deployment');
    </script>
</body>
</html>
